---
title: HTTP与HTTPS
date: 2020-07-08 16:37:13
categories:
	- Java面试
	- 计算机网络

---

#### HTTPS

>HTTPS是一种通过计算机网络进行安全通信的传输协议，经由HTTP进行通信，利用SSL/TLS建立全信道，加密数据包。HTTPS使用的主要目的是提供对网站服务器的身份认证，同时保护交换数据的隐私与完整性。
>
>PS:TLS是传输层加密协议，前身是SSL协议，由网景公司1995年发布，有时候两者不区分。

### SSL

>SSL（Security Sockets Layer，安全套接层）
>为网络通信提供安全及数据完整性的一种安全协议
>是操作系统对外的API，SSL3.0后更名为TLS
>采用身份验证和数据加密保证网络通信的安全和数据的完整性

<!--more-->

#### 加密的方式

对称加密：加密和解密都使用同一个密钥
非对称加密：加密使用的密钥和解密使用的密钥是不相同的
哈希算法：将任意长度的信息转换为固定长度的值，算法不可逆 （例如：MD5）
数字签名：证明某个消息或者文件是某人发出/认同的/未被修改过的。（将要发送的内容hash后的值一同传输）

#### HTTPS数据传输流程

![HTTP](/articleImage/2020-07-08/4.jpg)

1. 首先客户端通过URL访问服务器建立SSL连接。
2. 浏览器将支持的加密算法信息发送给服务器。
3. 服务器选择一套浏览器支持的加密算法，以证书的形式回发浏览器。
4. 浏览器验证证书合法性，并结合证书公钥加密信息发送给服务器。
5. 服务器使用私钥解密信息，验证哈希，加密响应消息回发浏览器。
6. 浏览器解密响应消息，并对消息整形验证，之后进行加密交互数据。

![HTTP](/articleImage/2020-07-08/5.png)

**数字证书内容**
包括了加密后服务器的公钥、权威机构的信息、服务器域名，还有经过CA私钥签名之后的证书内容（经过先通过Hash函数计算得到证书数字摘要，然后用权威机构私钥加密数字摘要得到数字签名)，签名计算方法以及证书对应的域名。

**验证证书安全性过程**
当客户端收到这个证书之后，使用本地配置的权威机构的公钥对证书进行解密得到服务端的公钥和证书的数字签名，数字签名经过CA公钥解密得到证书信息摘要。
然后证书签名的方法计算一下当前证书的信息摘要，与收到的信息摘要作对比，如果一样，表示证书一定是服务器下发的，没有被中间人篡改过。因为中间人虽然有权威机构的公钥，能够解析证书内容并篡改，但是篡改完成之后中间人需要将证书重新加密，但是中间人没有权威机构的私钥，无法加密，强行加密只会导致客户端无法解密，如果中间人强行乱修改证书，就会导致证书内容和证书签名不匹配。
那第三方攻击者能否让自己的证书显示出来的信息也是服务端呢？（伪装服务端一样的配置）显然这个是不行的，因为当第三方攻击者去CA那边寻求认证的时候CA会要求其提供例如域名的whois信息、域名管理邮箱等证明你是服务端域名的拥有者，而第三方攻击者是无法提供这些信息所以他就是无法骗CA他拥有属于服务端的域名。

#### HTTP与HTTPS的区别

1. HTTPS需要到CA申请证书，HTTP不需要。
2. HTTPS密文传输，HTTP明文传输。
3. 连接方式不同，HTTPS默认使用443端口，HTTP使用80端口。
4. HTTPS=HTTP+加密+认证+完整性保护，较HTTP安全。

#### HTTPS真的安全吗？

浏览器默认填充http:// ，请求需要进行跳转，有被劫持的风险
*可以使用HSTS优化*